<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="Setting up caddy on ubuntu to work with PHP">
<meta name="keywords" content="Ariestiyansyah,Caddy,Ubuntu,PHP">
<meta property="og:type" content="article">
<meta property="og:title" content="Setup Caddy with PHP on Ubuntu">
<meta property="og:url" content="http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/index.html">
<meta property="og:site_name" content="oonlab">
<meta property="og:description" content="Setting up caddy on ubuntu to work with PHP">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-02-26T20:08:04.543Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Setup Caddy with PHP on Ubuntu">
<meta name="twitter:description" content="Setting up caddy on ubuntu to work with PHP">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Setup Caddy with PHP on Ubuntu</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">archives</a></li>
         
          <li><a href="https://github.com/ariestiyansyah">Projects</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/Python/2019/02/27/2016-08-10-SpotiPy-play-spotify-with-applescript-and-python/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/edX/2019/02/27/2016-08-24-store-open-edx-image-profile-to-amazon-s3/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/&text=Setup Caddy with PHP on Ubuntu"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/&title=Setup Caddy with PHP on Ubuntu"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/&is_video=false&description=Setup Caddy with PHP on Ubuntu"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Setup Caddy with PHP on Ubuntu&body=Check out this article: http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/&title=Setup Caddy with PHP on Ubuntu"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/&title=Setup Caddy with PHP on Ubuntu"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/&title=Setup Caddy with PHP on Ubuntu"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/&title=Setup Caddy with PHP on Ubuntu"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/&name=Setup Caddy with PHP on Ubuntu&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Installation"><span class="toc-number">2.</span> <span class="toc-text">Installation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Setup"><span class="toc-number">3.</span> <span class="toc-text">System Setup</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Setup"><span class="toc-number">4.</span> <span class="toc-text">PHP Setup</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Site-Configuration"><span class="toc-number">4.1.</span> <span class="toc-text">Site Configuration</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Caddy-Configuration"><span class="toc-number">5.</span> <span class="toc-text">Caddy Configuration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Server-Configuration"><span class="toc-number">6.</span> <span class="toc-text">Server Configuration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Testing-PHP"><span class="toc-number">7.</span> <span class="toc-text">Testing PHP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CONCLUSION"><span class="toc-number">8.</span> <span class="toc-text">CONCLUSION</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Setup Caddy with PHP on Ubuntu
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">ariestiyansyah</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-02-26T20:08:04.543Z" itemprop="datePublished">2019-02-27</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/Code/">Code</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/Ariestiyansyah/">Ariestiyansyah</a>, <a class="tag-link" href="/tags/Caddy/">Caddy</a>, <a class="tag-link" href="/tags/PHP/">PHP</a>, <a class="tag-link" href="/tags/Ubuntu/">Ubuntu</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h4 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h4><p>Caddy is a very promising webserver (written in Go) that allows HTTP/2. It is a full-featured web server that includes the ability to enable HTTPS automatically. This allows for web server creation with high flexibility and low overhead. Creator claims caddy to be designed for human and it is probably the only of its kind. The purpose of Caddy is to streamline an authentic web development, deployment, and hosting workflow so that anyone can host their own web sites without requiring special technical knowledge. If you are designer, blogger and developer prefer to have a simple yet webserver with HTTP/2 support by default, Caddy is definitely worth checking out.</p>
<h4 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h4><p>You can run auto Caddy installation instead of download the file archive by running the following code in your terminal.</p>
<pre><code>curl https://getcaddy.com | bash
</code></pre><p>The command above will install caddy to <code>/usr/local/bin/caddy</code></p>
<h4 id="System-Setup"><a href="#System-Setup" class="headerlink" title="System Setup"></a>System Setup</h4><p>Allow caddy to use standard internal network post</p>
<pre><code>sudo setcap cap_net_bind_service=+ep /usr/local/bin/caddy
</code></pre><h4 id="PHP-Setup"><a href="#PHP-Setup" class="headerlink" title="PHP Setup"></a>PHP Setup</h4><p>Install PHP-fpm by running the following command:</p>
<p>PHP5</p>
<pre><code>sudo apt-get install php5-fpm php5-cli curl
</code></pre><p>PHP7</p>
<pre><code>sudo apt-get install php7.0-fpm php7.0-cli curl
</code></pre><h5 id="Site-Configuration"><a href="#Site-Configuration" class="headerlink" title="Site Configuration"></a>Site Configuration</h5><p>Create web server root directory to store all of your webpages like .php, .html, ect.</p>
<pre><code>sudo mkdir -p /opt/www
sudo chown -R www-data:www-data
</code></pre><h4 id="Caddy-Configuration"><a href="#Caddy-Configuration" class="headerlink" title="Caddy Configuration"></a>Caddy Configuration</h4><p>Create the directory we’ll be using to store Caddyfile and ssl, give user perms to write to it:</p>
<pre><code>sudo mkdir /etc/caddy
sudo chown -R root:www-data /etc/caddy
sudo mkdir /etc/ssl/caddy
sudo chown -R www-data:root /etc/ssl/caddy
chmod 0770 /etc/ssl/caddy
</code></pre><p>Create <code>Caddyfile</code> which the main configuration file of Caddy.</p>
<pre><code>sudo vim /etc/caddy/Caddyfile
</code></pre><p>Put the following code:</p>
<pre><code>yourdomain.com {
root /opt/www
tls your@yourdomain.com.com
}
</code></pre><ul>
<li><strong>root /opt/www</strong> : point the web server root directory to /opt/www</li>
<li><strong>tls <a href="mailto:your@yourdomain.com" target="_blank" rel="noopener">your@yourdomain.com</a></strong> : configures HTTPS connections</li>
</ul>
<p>To configure php settings with more granularity, you can use the fastcgi directive.</p>
<pre><code>fastcgi / /var/run/php/php7.0-fpm.sock {
    ext     .php
    split    .php
    index    index.php
}
</code></pre><ul>
<li><strong>ext</strong> : if requested file has the .php extension use fastcgi proxy</li>
<li><strong>split</strong> : To store anything after .php in the PATH_INFO CGI variable</li>
<li><strong>index</strong>: To check for index.php if no file is specified in the URL</li>
</ul>
<p>Note:<br>Use the following socket path for PHP5</p>
<pre><code>/var/run/php5-fpm.sock
</code></pre><h4 id="Server-Configuration"><a href="#Server-Configuration" class="headerlink" title="Server Configuration"></a>Server Configuration</h4><p>Now we create a systemd configuration file <code>/etc/systemd/system/caddy.service</code>, which looks like this:</p>
<pre><code>[Unit]
Description=Caddy HTTP/2 web server
Documentation=https://caddyserver.com/docs
After=network-online.target
Wants=network-online.target systemd-networkd-wait-online.service

[Service]
Restart=on-failure

User=www-data
Group=www-data

Environment=HOME=/etc/ssl/caddy

ExecStart=/usr/local/bin/caddy -log stdout -agree=true -conf=/etc/caddy/Caddyfile -root=/var/tmp
ExecReload=/bin/kill -USR1 $MAINPID

LimitNOFILE=4096
LimitNPROC=64

PrivateTmp=true
PrivateDevices=true
ProtectHome=true
ProtectSystem=full
ReadWriteDirectories=/etc/ssl/caddy

CapabilityBoundingSet=CAP_NET_BIND_SERVICE
AmbientCapabilities=CAP_NET_BIND_SERVICE
NoNewPrivileges=true

[Install]
WantedBy=multi-user.target
</code></pre><h4 id="Testing-PHP"><a href="#Testing-PHP" class="headerlink" title="Testing PHP"></a>Testing PHP</h4><p>With a Caddy web server configured and the PHP packages installed, we should be able to verify that PHP is up and running. Begin by checking the installed version of PHP at the command line:</p>
<pre><code>$ php -v
PHP 7.0.8-0ubuntu0.16.04.2 (cli) ( NTS )
Copyright (c) 1997-2016 The PHP Group
Zend Engine v3.0.0, Copyright (c) 1998-2016 Zend Technologies
    with Zend OPcache v7.0.8-0ubuntu0.16.04.2, Copyright (c) 1999-2016, by Zend Technologies
</code></pre><p>You can also create a test file in the web server root directory, which is /opt/www</p>
<p>Using Vim, create the file called into.php  in the web server root directory</p>
<pre><code>sudo vim /opt/www/tes.php
</code></pre><p>Paste the following code into <code>tes.php</code></p>
<pre><code>&lt;?php
phpinfo();
?&gt;
</code></pre><p>Exit and save tes.php from your editor. Now, load the following address in your browser:</p>
<pre><code>https://yourdomain.com/tes.php
</code></pre><p>You should see PHP version and configuration info for PHP. Once you’ve double-checked this, it’s safest to to delete testing file.</p>
<pre><code>sudo rm -r /opt/www/tes.php
</code></pre><h4 id="CONCLUSION"><a href="#CONCLUSION" class="headerlink" title="CONCLUSION"></a>CONCLUSION</h4><p>Now, you have working Caddy web server with PHP feature.</p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">archives</a></li>
         
          <li><a href="https://github.com/ariestiyansyah">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Installation"><span class="toc-number">2.</span> <span class="toc-text">Installation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#System-Setup"><span class="toc-number">3.</span> <span class="toc-text">System Setup</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP-Setup"><span class="toc-number">4.</span> <span class="toc-text">PHP Setup</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Site-Configuration"><span class="toc-number">4.1.</span> <span class="toc-text">Site Configuration</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Caddy-Configuration"><span class="toc-number">5.</span> <span class="toc-text">Caddy Configuration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Server-Configuration"><span class="toc-number">6.</span> <span class="toc-text">Server Configuration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Testing-PHP"><span class="toc-number">7.</span> <span class="toc-text">Testing PHP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CONCLUSION"><span class="toc-number">8.</span> <span class="toc-text">CONCLUSION</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/&text=Setup Caddy with PHP on Ubuntu"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/&title=Setup Caddy with PHP on Ubuntu"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/&is_video=false&description=Setup Caddy with PHP on Ubuntu"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Setup Caddy with PHP on Ubuntu&body=Check out this article: http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/&title=Setup Caddy with PHP on Ubuntu"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/&title=Setup Caddy with PHP on Ubuntu"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/&title=Setup Caddy with PHP on Ubuntu"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/&title=Setup Caddy with PHP on Ubuntu"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://oonlab.com/Code/2019/02/27/2016-08-12-setup-caddy-on-ubuntu-to-work-with-php/&name=Setup Caddy with PHP on Ubuntu&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 Rizky Ariestiyansyah
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">archives</a></li>
         
          <li><a href="https://github.com/ariestiyansyah">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'oonlab';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


</body>
</html>
